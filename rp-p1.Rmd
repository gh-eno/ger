---
title: "Modelos Lineares - Prova 1"
author: "Ramon Gheno 155118"
date: '2022-03-31'
output:
  html_document: default
word_document: default
pdf_document: default
editor_options: 
  markdown: 
    wrap: 72
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Respostas

## 1)

![image info](/home/beta/Pictures/ml-p1-1a.jpeg)

![image info](/home/beta/Pictures/ml-p1-1b.jpeg)

## 2)

![image info](/home/beta/Pictures/ml-p1-2.jpeg)

## 3)

a)verdadeiro, pois:

E[b0chapeu] = E[Ybarra - B1chapeu]

= E[Ybarra] - E[b1Xbarra]

= 1/nE[somatorioYi] - XbarraE[b1chapeu]

=1/n somatorioE(Yi) - b1Xbarra

= 1/n somatorio(b0 + b1Xi) - b1Xbarra

= b0 + b1Xbarra - b1Xbarra

=b0

logo: E[b0chapeu] = b0

b)falso, o estimador linear não tendencioso mais preciso é o EMQ

c)verdadeiro, atraves dessa supsição, por exemplo, podemos encontrar os
estimadores de maxima verossimilhança ao considerar epsilon i \~
N(0,sigma\^2)

d)verdadeiro, pois os pontos de afastam da reta preditora.

e)falso, heteroscedasticidade ocorre quando o modelo apresenta varicias
para X e Y não iguais para todas as observações.

## 4)

a)  Essa afimação é falsa, podemos definir o valor de p como sendo a
    probabilidade de obter uma estatística de teste igual ou mais
    extremo que o observado, dado a hipotese nula como correta.

b)  Essa afirmação também é falsa, pois o valor de p fornce um indício
    de que aquela informação esteja proximo da verdade naquela amostra
    em particular. Esse valor pode ser últil ou não, prático ou não,
    relevante ou não, dependendo do contexto em que for aplicado,
    dependendo do desenho do estudo e dos objetivos do estudo.

## 5)

![image info](/home/beta/Pictures/ml-p1-5.jpeg)

## 6)

![image info](/home/beta/Pictures/ml-p1-6-.jpeg)

## 7)

a)Antes do teste foi feito um gráfico boxplot para termos uma idéia da
variação dos dados. Após foi utilizado o teste de hipóteses ANOVA e nele
não foram observadas diferenças na renda em relação a etnia (estatistica
F de 0,3232 e p-valor de 0,724), conforme codigo abaixo.

```{r}
install.packages("ISLR")
install.packages("ggplot2")

library(ISLR)
library(ggplot2)

dados <- Credit

summary(dados)

str(dados)

ggplot(dados, mapping = aes(x = Ethnicity, y = Income, colour = Ethnicity)) +
  geom_boxplot(aes(fill = Ethnicity), alpha= 0.2)+
  geom_jitter(width = 0.2)+
  geom_hline(aes(yintercept = mean(Income)), color = "black", size=0.7)+
  ggtitle("Boxplot da amostra")


modelo = lm(Income~Ethnicity, data = dados)
modelo
summary(modelo)

anova(modelo)

```

b)Para a comparação entre as diferentes etnias foi realizado teste de
Tukey, onde a média é comparada 2 a 2. Como o valor 0 está entre os
limites superiores e inferiores podemos suspeitar que não há diferença
significativa entre eles, o p-valor ajustado é maior de 0,05 o que, dado
um nível de significancia de 5%, indica que realmente não há diferença
na renda.

```{r}
install.packages("mosaic")
library(mosaic) # Plot TukeyHSD

TukeyHSD(modelo)

par(oma=c(0,5,0,0)) # ajusta as margens

plot(TukeyHSD(modelo, conf.level = 0.95),las=1, col = "red")


```

c)Para avaliar as suposições do modelo, devemos proceder a análise dos
resíduos a fim de verificar a normalidade(1), homoscedasticidade(2) e
pontos influentes(3).

1)Normalidade

Pelo teste de Shapiro-Wilk os dados não provem de uma distribuição
normal:

```{r}
residuos<-residuals(modelo)
shapiro.test(residuos)
```

Também a análise gráfica da densidade indica uma distribuição não normal

```{r}

ggplot(mapping = aes(x = residuos)) +   geom_density() +
  xlab("Residuos") + ylab(" ") + xlim(-10,10)
```

E o gráfico QQPlot também inidica uma distribuição não normal, pois os
quantis dos residuos esta muito afastados da normal

```{r}

install.packages("ggfortify")
library(ggfortify)
autoplot(modelo, which = 2, label.size = 3)

```

Logo, com base nas avaliações acima expostas os dados do resíduo não
seguem uma distribuição normal.

2)Homoscedasticidade Pelo Boxplot notamos que a variação é similar em
torno da média.

```{r}
library(ggplot2)
ggplot(data = dados, mapping=aes(x = Ethnicity, y = Income, fill = Income)) +
  geom_boxplot(alpha = 0.2) +
  geom_jitter(width = 0.05, aes(color = Income))


autoplot(modelo, which = 1, label.size = 3)

```

Pela Analise de Breusch-Pagan os dados são heteroscedasticos.

```{r}
install.packages("kableExtra")
install.packages("lmtest")
library(lmtest)
library(kableExtra)
homo.test = cbind(bptest(modelo, studentize = FALSE)$statistic, 
                  bptest(modelo, studentize = FALSE)$p.value)

rownames(homo.test) = c("Breusch-Pagan")
colnames(homo.test) = c("Statistic", "P.value")

kable(homo.test, align = "c", caption = "Teste de homocedasticidade")
```

3)Pontos Influentes

```{r}
lm(Income ~ Ethnicity, data = dados) %>%
  mplot(smooth.color = "blue", smooth.size = 1.2, smooth.alpha = 0.3, id.size = 3)


autoplot(modelo, which = c(3:5), label.size = 3)
```

Pelo exposto acima as suposicões de normalidade não ocorrem, logo a
inferencia fica prejudicada e é recomendável uma amostra maior para
avaliar se a etnia infuencia a renda.

d)  

d)Baseado na função lm, podemos calcular a equação como:

```{r}
modelo = lm(Income~Ethnicity, data = dados)
modelo
```

Assim: para afroamericanos y = 47 -3,5x0 - 3,2x0 para asiáticos y = 47,7
-3,5x1 -3,2x0 para caucasianos y = 47 -3,5x0 - 3,2x1

## 8)

a)  Para a analise grafica foram utilizados histogramas e um gráfico de
    correlação linar simples.

```{r}
library(tidyverse)
summary(diamonds)
dados <- diamonds 
hist(dados$price)
hist(dados$carat)
plot(dados$carat ~ dados$price)
```

b)O modelo de regressão pode ser calculado como

```{r}
modelo = lm(price~carat, data = dados)
modelo
```

assim:

y = -2256 +7756 \* x

e o gráfico

```{r}
library(ggplot2)

ggplot(data = dados, aes(x = carat, y = price)) +
  geom_point()
```

c)O coeficiente B0 é negativo, o B1 apresenta um valor muito algo, assim
pedras com baixo peso apresentam um preço alto.

d)Ao utilizar anova(modelo) observamos que o peso afeta
significativamente o preço das pedras.

```{r}
anova(modelo)
```

e)Analise dos resíduos, verificaremos a normalidade(1),
homoscedasticidade(2) e pontos influentes(3).

1)Normalidade

O teste de Shapiro não foi executado em função do numero de dados.

```{r}
residuos<-residuals(modelo)
shapiro.test(residuos)
```

A analise gráfica da densidade indica uma possivel normalidade.

```{r}

ggplot(mapping = aes(x = residuos)) +   geom_density() +
  xlab("Residuos") + ylab(" ") + xlim(-10,10)
```

E o gráfico QQPlot inidica uma distribuição não normal, pois os quantis
dos residuos estao muito afastados da normal, sobretudo nas extremidades

```{r}

install.packages("ggfortify")
library(ggfortify)
autoplot(modelo, which = 2, label.size = 3)

```

Logo, com base nas avaliações acima expostas os dados do resíduo não
seguem uma distribuição normal.

2)Homoscedasticidade Pelo Boxplot notamos que a variação não é similar
em torno da média.

```{r}
library(ggplot2)
ggplot(data = dados, mapping=aes(x = carat, y = price, fill = price)) +
  geom_boxplot(alpha = 0.2) +
  geom_jitter(width = 0.05, aes(color = price))


autoplot(modelo, which = 1, label.size = 3)

```

Pela Analise de Breusch-Pagan os dados são heteroscedasticos.

```{r}
install.packages("lmtest") install.packages("knitr") library(lmtest)
library(knitr) homo.test = cbind(bptest(modelo, studentize =
FALSE)$statistic,  bptest(modelo, studentize = FALSE)$p.value)

rownames(homo.test) = c("Breusch-Pagan") colnames(homo.test) =
c("Statistic", "P.value")

kable(homo.test, align = "c", caption = "Teste de homocedasticidade")
```
3)Pontos Influentes

```{r}
lm(price \~ carat, data = dados) %\>% mplot(smooth.color = "blue",
smooth.size = 1.2, smooth.alpha = 0.3, id.size = 3)

autoplot(modelo, which = c(3:5), label.size = 3)
```

Pelo exposto acima as suposicões de normalidade não ocorrem.

f)  O coeficiente de correlação r é de 0,92 e o r\^2 é de 0,85, ou seja
    apresentam uma correlação positiva muito forte.

```{r}
cor(dados$carat, dados$price)
modelo = lm(price~carat, data = dados)
modelo
summary(modelo)
```

g)Ao usar a equação do item b) uma pedra com peso de 0,6 apresenta um
valor de: 2.397,6

y = -2256 +7756 \* x
